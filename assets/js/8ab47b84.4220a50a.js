(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{120:function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return u}));var o=r(0),a=r.n(o);function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){i(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t){if(null==e)return{};var r,o,a=function(e,t){if(null==e)return{};var r,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var c=a.a.createContext({}),l=function(e){var t=a.a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},p=function(e){var t=l(e.components);return a.a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.a.createElement(a.a.Fragment,{},t)}},b=a.a.forwardRef((function(e,t){var r=e.components,o=e.mdxType,i=e.originalType,n=e.parentName,c=d(e,["components","mdxType","originalType","parentName"]),p=l(r),b=o,u=p["".concat(n,".").concat(b)]||p[b]||h[b]||i;return r?a.a.createElement(u,s(s({ref:t},c),{},{components:r})):a.a.createElement(u,s({ref:t},c))}));function u(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=r.length,n=new Array(i);n[0]=b;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:o,n[1]=s;for(var c=2;c<i;c++)n[c]=r[c];return a.a.createElement.apply(null,n)}return a.a.createElement.apply(null,r)}b.displayName="MDXCreateElement"},171:function(e,t,r){"use strict";r.r(t),t.default=r.p+"assets/images/hydro-registry-diagram-e5c2e393ded8b5b0996588f6125f6e9c.png"},96:function(e,t,r){"use strict";r.r(t),r.d(t,"frontMatter",(function(){return n})),r.d(t,"metadata",(function(){return s})),r.d(t,"toc",(function(){return d})),r.d(t,"default",(function(){return l}));var o=r(3),a=r(7),i=(r(0),r(120)),n={slug:"fluttering-over-the-air",title:"Fluttering Over the Air",author:"Chris Gibb",author_title:"Recovering Structural Typing Enthusiast",author_url:"https://github.com/chgibb",author_image_url:"https://avatars.githubusercontent.com/u/18079458?s=400&v=4",tags:["flutter","typescript","react-native","hot-reload","codepush"],keywords:["flutter","typescript","react-native","hot-reload","codepush"],description:"Codepush for Flutter"},s={permalink:"/blog/fluttering-over-the-air",editUrl:"https://github.com/hydro-sdk/hydro-sdk.io/edit/main/blog/2021-07-16-fluttering-over-the-air.md",source:"@site/blog/2021-07-16-fluttering-over-the-air.md",title:"Fluttering Over the Air",description:"Codepush for Flutter",date:"2021-07-16T00:00:00.000Z",formattedDate:"July 16, 2021",tags:[{label:"flutter",permalink:"/blog/tags/flutter"},{label:"typescript",permalink:"/blog/tags/typescript"},{label:"react-native",permalink:"/blog/tags/react-native"},{label:"hot-reload",permalink:"/blog/tags/hot-reload"},{label:"codepush",permalink:"/blog/tags/codepush"}],readingTime:6.17,truncated:!0,prevItem:{title:"DartUP 2021",permalink:"/blog/dartup-2021"},nextItem:{title:"Mangling Dynamic Language Symbols, Uniquely Addressing the Atoms of Hot-Reload",permalink:"/blog/mangling-dynamic-language-symbols"}},d=[{value:"Registry",id:"registry",children:[]},{value:"Codepush",id:"codepush",children:[]},{value:"App Store Compliance",id:"app-store-compliance",children:[]},{value:"Service Status",id:"service-status",children:[]},{value:"Licensing",id:"licensing",children:[]},{value:"Caveats and Future Work",id:"caveats-and-future-work",children:[{value:"State Management",id:"state-management",children:[]},{value:"API Availability",id:"api-availability",children:[]},{value:"Performance",id:"performance",children:[]},{value:"Compiling to Dart",id:"compiling-to-dart",children:[]}]},{value:"Monetization",id:"monetization",children:[{value:"Sponsorhips",id:"sponsorhips",children:[]},{value:"Consulting and Services",id:"consulting-and-services",children:[]}]},{value:"Next Alpha Release",id:"next-alpha-release",children:[]}],c={toc:d};function l(e){var t=e.components,n=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(o.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Announcing Hydro-SDK ",Object(i.b)("inlineCode",{parentName:"p"},"0.0.1-alpha.0")," and Codepush for Flutter"),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://flutter.dev/"},"Flutter")," is Google's UI toolkit for building beautiful, natively compiled applications for mobile, web, desktop and embedded devices from a single codebase."),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk"},"Hydro-SDK"),' is a software development kit (SDK) enabling Flutter developers to write portions of their app (or their entire app) using TypeScript. It is a project with one large, ambitious goal. "Become React Native for Flutter".',Object(i.b)("br",{parentName:"p"}),"\n","It aims to do that by:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Decoupling the API surface of Flutter from  the Dart programming language."),Object(i.b)("li",{parentName:"ol"},"Decoupling the development time experience of Flutter from the Dart programming language."),Object(i.b)("li",{parentName:"ol"},"Providing first-class support for over-the-air distribution of code."),Object(i.b)("li",{parentName:"ol"},"Providing an ecosystem of packages from ",Object(i.b)("inlineCode",{parentName:"li"},"pub.dev"),", automatically projected to supported languages and published to other package systems.")),Object(i.b)("p",null,"In this article I want to announce and describe the realization of goal 3."),Object(i.b)("h2",{id:"registry"},"Registry"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Registry Diagram",src:r(171).default}),"\nRegistry is a service for publishing and delivering ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.io/docs/design-documents/ota"},Object(i.b)("inlineCode",{parentName:"a"},".ota")," (over-the-air) package files")," produced for Hydro-SDK components."),Object(i.b)("p",null,"Hydro-SDK builds and manages code in terms of projects. Projects consist of components. Hydro-SDK content is embedded into a host app using the ",Object(i.b)("inlineCode",{parentName:"p"},"RunComponent")," widget. While developing with Hydro-SDK locally, the ",Object(i.b)("inlineCode",{parentName:"p"},"RunComponent")," widget and ",Object(i.b)("inlineCode",{parentName:"p"},"hydroc run")," command work together to rebuild and hot-reload your code as you make changes. See the ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.io/docs/intro"},"getting started tutorial")," for a full description."),Object(i.b)("p",null,"This is great when developing locally using Hydro-SDK. What if your entire app isn't written with Hydro-SDK? What about developers writing Dart code in an app where Hydro-SDK is only a small part? Should they have to worry about having ",Object(i.b)("inlineCode",{parentName:"p"},"hydroc run")," running? What about end users of your app? This is where the Hydro-SDK Registry comes in."),Object(i.b)("p",null,"The Hydro-SDK Registry is available at ",Object(i.b)("a",{parentName:"p",href:"https://registry.hydro-sdk.io"},"https://registry.hydro-sdk.io")," In cases when ",Object(i.b)("inlineCode",{parentName:"p"},"hydroc run")," is not available during local development or when your app is running in profile or release mode, the ",Object(i.b)("inlineCode",{parentName:"p"},"RunComponent")," widget will look to the Registry for the latest available package for a given component. "),Object(i.b)("p",null,"See ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.io/docs/codepush"},"the tutorial")," to get started using Registry to quickly deliver Flutter experiences built with Hydro-SDK to your users"),Object(i.b)("h2",{id:"codepush"},"Codepush"),Object(i.b)("p",null,"Packages can be published to the Registry using the new ",Object(i.b)("inlineCode",{parentName:"p"},"hydroc codepush")," command. All packages are signed using the private key generated when you create the corresponding component on the Registry. Packages can be verified at runtime using the generated public key."),Object(i.b)("p",null,"Registry is completely free and connects with your existing Github account. See the ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.io/docs/codepush"},"codepush tutorial"),"."),Object(i.b)("h2",{id:"app-store-compliance"},"App Store Compliance"),Object(i.b)("p",null,"There is endless discussion on every corner of the internet dissecting and debating App Store rules and guidelines. The ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/counter-app"},"Hydro-SDK counter app showcase")," has been successfully published to Google Play. An App Store version is in progress.",Object(i.b)("br",{parentName:"p"}),"\n","Google Play: ",Object(i.b)("a",{parentName:"p",href:"https://play.google.com/store/apps/details?id=com.hydro_sdk.counter_app"},"https://play.google.com/store/apps/details?id=com.hydro_sdk.counter_app"),Object(i.b)("br",{parentName:"p"}),"\n","Registry: ",Object(i.b)("a",{parentName:"p",href:"https://registry.hydro-sdk.io/#/component/63bbc0f5-0080-439c-999e-2323462beede"},"https://registry.hydro-sdk.io/#/component/63bbc0f5-0080-439c-999e-2323462beede")),Object(i.b)("h2",{id:"service-status"},"Service Status"),Object(i.b)("p",null,"Like Hydro-SDK itself, Registry is still in an incredibly early stage. We are looking for members of the community to try Hydro-SDK, Registry and codepush and provide their feedback and experience. Consequently, there is no official service level agreement (SLA) at this time. Please reach out on ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/issues"},"Github issues"),", ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/discussions"},"Github discussions"),", ",Object(i.b)("a",{parentName:"p",href:"https://discord.com/invite/DuM2vkUSNr"},"Discord"),', or email us at "hello (at) hydro-sdk.io".'),Object(i.b)("h2",{id:"licensing"},"Licensing"),Object(i.b)("p",null,"For a large part of Hydro-SDKs existence, it has been licensed under the GNU Affero General Public License Version 3 (AGPL-3). This was done in order to make it harder for companies to take the open-source Hydro-SDK and monetize it by providing value added services (like codepush) around it. Starting from Hydro-SDK ",Object(i.b)("inlineCode",{parentName:"p"},"0.0.1-alpha.0")," and ",Object(i.b)("inlineCode",{parentName:"p"},"0.0.1-nightly.289"),', Hydro-SDK will be licensed under the far more permissive MIT license. If you\'re a business or other entity for which the MIT license does not meet your needs, please reach out at "hello (at) hydro-sdk.io".'),Object(i.b)("h2",{id:"caveats-and-future-work"},"Caveats and Future Work"),Object(i.b)("h3",{id:"state-management"},"State Management"),Object(i.b)("p",null,"The only state management technique available to code written with Hydro-SDK is ",Object(i.b)("inlineCode",{parentName:"p"},"setState"),". There is a hand-written port of ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/tree/master/runtime/scopedModel"},Object(i.b)("inlineCode",{parentName:"a"},"package:scoped_model")," in the Hydro-SDK source distribution")," though it is not quite polished enough to recommend it for use in any official tutorials or guides."),Object(i.b)("h3",{id:"api-availability"},"API Availability"),Object(i.b)("p",null,"The APIs currently available from Hydro-SDK can be viewed on ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.github.io/hydro-sdk/"},"https://hydro-sdk.github.io/hydro-sdk/")," It is quite limited in comparison to what ",Object(i.b)("inlineCode",{parentName:"p"},"dart:*")," standard libraries and ",Object(i.b)("inlineCode",{parentName:"p"},"package:flutter")," have to offer. Not to mention packages from ",Object(i.b)("inlineCode",{parentName:"p"},"pub.dev"),". Hydro-SDKs ",Object(i.b)("a",{parentName:"p",href:"https://hydro-sdk.io/docs/design-documents/swid"},"SWID project")," aims to build tooling to automatically make public APIs from Dart packages available to use from Hydro-SDK. SWID is still in its infancy. However, classes from Flutter like ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/flutter/material/icons.ts"},"Material icons")," and ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/flutter/cupertino/cupertinoIcons.ts"},"Cupertino icons")," have been brought to TypeScript and Hydro-SDK users thanks to SWID. The entire ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/tree/master/runtime/dart/typed_data"},Object(i.b)("inlineCode",{parentName:"a"},"dart:typed_data")," library"),", and extremely complicated classes like ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/dart/core/iterable.ts"},Object(i.b)("inlineCode",{parentName:"a"},"Iterable")," from ",Object(i.b)("inlineCode",{parentName:"a"},"dart:core"))," have been made available thanks to SWID. The code that SWID produces is correct enough to pass test cases from ",Object(i.b)("a",{parentName:"p",href:"https://github.com/dart-lang/co19"},"Dart's library conformance test suite (CO19)")," ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/tree/master/test/co19/core/iterable"},"that have been ported into TypeScript"),"."),Object(i.b)("p",null,"Hydro-SDK aims to become a toolkit to extend Flutter not just to TypeScript but to other languages like Haxe and C#. SWID is the cornerstone of this vision. Making SWID smart enough to handle ",Object(i.b)("inlineCode",{parentName:"p"},"dart:ui")," is next and can be tracked ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/projects/17"},"here"),". All work related to SWID can be tracked ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/projects/5"},"here"),"."),Object(i.b)("h3",{id:"performance"},"Performance"),Object(i.b)("p",null,"Hydro-SDKs build system takes in TypeScript code and produces Lua bytecode to be run on the common Flutter runtime (CFR) virtual machine on a host Flutter app. Other than stripping debug symbols when building for release mode (which commands like ",Object(i.b)("inlineCode",{parentName:"p"},"hydroc codepush")," do automatically), no ahead of time optimizations are done. "),Object(i.b)("p",null,"There is a lot of low hanging fruit to be picked in this area. Lua bundle collapsing (in a similar manner to the optimization performed by ",Object(i.b)("a",{parentName:"p",href:"https://github.com/browserify/bundle-collapser"},"Browserify"),") in particular could realise some immediate size savings in terms of generated bytecode. "),Object(i.b)("p",null,"The most impactful optimization that can be done at the TypeScript level is tree-shaking. Bytecode produced by Hydro-SDK tends to be dominated by ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/flutter/material/icons.ts"},"Material icons"),", ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/flutter/cupertino/cupertinoIcons.ts"},"Cupertino icons"),", ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/blob/master/runtime/flutter/material/colors.ts"},"Material colors")," and the like. Tree-shaking could remove this unneccessary overhead in bytecode size."),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://www.ideals.illinois.edu/bitstream/handle/2142/78638/WANG-DISSERTATION-2015.pdf?sequence=1&isAllowed=y"},"Wang"),", ",Object(i.b)("a",{parentName:"p",href:"https://sites.cs.ucsb.edu/~ckrintz/papers/TCD-CS-2009-37.pdf"},"Williams et al")," and ",Object(i.b)("a",{parentName:"p",href:"https://nymphium.github.io/pdf/opeth_report.pdf"},"Kawahara")," have all performed extensive research into applying traditional ahead of time optimization techniques to Lua bytecode. Others like ",Object(i.b)("a",{parentName:"p",href:"https://www.complang.tuwien.ac.at/anton/praktika-fertig/schroeder/thesis.pdf"},"Shroder")," have explored runtime optimizations. In the future, finding a combination of these approaches and techniques will allow users of Hydro-SDK to deliver the smallest possible bytecode updates to their users"),Object(i.b)("h3",{id:"compiling-to-dart"},"Compiling to Dart"),Object(i.b)("p",null,"Tooling exists to compile Lua bytecode into Dart code that can then be compiled with a host app and recognized by CFR at runtime. This capability is tested on every commit as part of Hydro-SDKs CI in both ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/actions/workflows/debug-ts-aot-integrationTests.yml"},"debug")," and ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/actions/workflows/release-ts-aot-integrationTests.yml"},"release")," modes. This feature holds a lot of promise at improving the performance of CPU bound operations that would otherwise be performed in bytecode. The benchmarks, tooling and other polish required to make this feature available where not ready for the ",Object(i.b)("inlineCode",{parentName:"p"},"0.0.1-alpha.0")," release."),Object(i.b)("h2",{id:"monetization"},"Monetization"),Object(i.b)("p",null,Object(i.b)("a",{parentName:"p",href:"https://github.com/publicdomaincompany"},"Public Domain Publishing")," has been a generous sponsor of Hydro-SDK. Monetization goals include having enough recurring income to allow the primary developer to work full time on Hydro-SDK and to hire or otherwise compensate other members of the community who contribute to Hydro-SDK."),Object(i.b)("h3",{id:"sponsorhips"},"Sponsorhips"),Object(i.b)("p",null,"Hydro-SDK can be sponsored on ",Object(i.b)("a",{parentName:"p",href:"https://github.com/sponsors/hydro-sdk"},"Github Sponsors")," and ",Object(i.b)("a",{parentName:"p",href:"https://opencollective.com/hydro-sdk"},"Open Collective"),"."),Object(i.b)("h3",{id:"consulting-and-services"},"Consulting and Services"),Object(i.b)("p",null,'If you\'re a business looking for consulting or other services related to Hydro-SDK, email us at "hello (at) hydro-sdk.io".'),Object(i.b)("h2",{id:"next-alpha-release"},"Next Alpha Release"),Object(i.b)("p",null,"Very preliminary planning has begun for ",Object(i.b)("inlineCode",{parentName:"p"},"0.0.1-alpha.1"),". This work can be tracked ",Object(i.b)("a",{parentName:"p",href:"https://github.com/orgs/hydro-sdk/projects/4"},"here"),". Please reach out on ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/issues"},"Github issues"),", ",Object(i.b)("a",{parentName:"p",href:"https://github.com/hydro-sdk/hydro-sdk/discussions"},"Github discussions"),", ",Object(i.b)("a",{parentName:"p",href:"https://discord.com/invite/DuM2vkUSNr"},"Discord"),', or email us at "hello (at) hydro-sdk.io" to help drive the direction of Hydro-SDK. Code contributions and pull requests are encouraged and accepted.'))}l.isMDXComponent=!0}}]);